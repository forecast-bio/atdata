# Issue #30: Implement querying and discovery of datasets

## REVIEW

We should add an issue to design this system in greater detail, with more flexibility in the types of queries, particularly for querying the full atmosphere or individual users there.

## Verdict: CLOSE

## Evidence
Querying and discovery is implemented across multiple layers. `DatasetLoader.list_all()` lists all dataset records from a repository. `LensLoader.find_by_schemas()` discovers lenses by source/target schema URIs. `LabelLoader.resolve()` resolves named labels to dataset AT URIs with optional version filtering. `Atmosphere.list_schemas()`, `list_datasets()`, `list_lenses()`, `list_labels()` provide convenience listing methods. The `load_dataset()` function in `_hf_api.py` supports AT URI resolution (`at://...`) for direct record access, enabling end-users to load datasets by their ATProto identifiers without manual publisher/loader usage. The `_AtmosphereBackend` in `repository.py` routes `@handle/dataset` paths through the atmosphere for unified Index access.

## Codebase References
- `src/atdata/atmosphere/records.py` lines 476-490 -- `DatasetLoader.list_all()` lists dataset records
- `src/atdata/atmosphere/lens.py` lines 261-288 -- `LensLoader.find_by_schemas()` discovers lenses by schema
- `src/atdata/atmosphere/labels.py` lines 149-198 -- `LabelLoader.resolve()` named label resolution with version support
- `src/atdata/atmosphere/client.py` lines 537-620 -- `list_schemas()`, `list_datasets()`, `list_lenses()`, `list_labels()`
- `src/atdata/_hf_api.py` lines 482-492 -- `_is_at_uri()` checks for `at://` prefix
- `src/atdata/_hf_api.py` lines 494-591 -- `_resolve_at_uri()` resolves AT URI to Dataset + type
- `src/atdata/_hf_api.py` lines 867-877 -- `load_dataset()` AT URI handling branch
- `src/atdata/repository.py` lines 172-188 -- `_AtmosphereBackend.list_datasets()` via atmosphere
