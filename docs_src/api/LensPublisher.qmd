# LensPublisher { #atdata.atmosphere.LensPublisher }

```python
atmosphere.LensPublisher(client)
```

Publishes Lens transformation records to ATProto.

This class creates lens records that reference source and target schemas
and point to the transformation code in a git repository.

Example:
    >>> @atdata.lens
    ... def my_lens(source: SourceType) -> TargetType:
    ...     return TargetType(field=source.other_field)
    >>>
    >>> client = AtmosphereClient()
    >>> client.login("handle", "password")
    >>>
    >>> publisher = LensPublisher(client)
    >>> uri = publisher.publish(
    ...     name="my_lens",
    ...     source_schema_uri="at://did:plc:abc/ac.foundation.dataset.sampleSchema/source",
    ...     target_schema_uri="at://did:plc:abc/ac.foundation.dataset.sampleSchema/target",
    ...     code_repository="https://github.com/user/repo",
    ...     code_commit="abc123def456",
    ...     getter_path="mymodule.lenses:my_lens",
    ...     putter_path="mymodule.lenses:my_lens_putter",
    ... )

Security Note:
    Lens code is stored as references to git repositories rather than
    inline code. This prevents arbitrary code execution from ATProto
    records. Users must manually install and trust lens implementations.

## Methods

| Name | Description |
| --- | --- |
| [publish](#atdata.atmosphere.LensPublisher.publish) | Publish a lens transformation record to ATProto. |
| [publish_from_lens](#atdata.atmosphere.LensPublisher.publish_from_lens) | Publish a lens record from an existing Lens object. |

### publish { #atdata.atmosphere.LensPublisher.publish }

```python
atmosphere.LensPublisher.publish(
    name,
    source_schema_uri,
    target_schema_uri,
    description=None,
    code_repository=None,
    code_commit=None,
    getter_path=None,
    putter_path=None,
    rkey=None,
)
```

Publish a lens transformation record to ATProto.

Args:
    name: Human-readable lens name.
    source_schema_uri: AT URI of the source schema.
    target_schema_uri: AT URI of the target schema.
    description: What this transformation does.
    code_repository: Git repository URL containing the lens code.
    code_commit: Git commit hash for reproducibility.
    getter_path: Module path to the getter function
        (e.g., 'mymodule.lenses:my_getter').
    putter_path: Module path to the putter function
        (e.g., 'mymodule.lenses:my_putter').
    rkey: Optional explicit record key.

Returns:
    The AT URI of the created lens record.

Raises:
    ValueError: If code references are incomplete.

### publish_from_lens { #atdata.atmosphere.LensPublisher.publish_from_lens }

```python
atmosphere.LensPublisher.publish_from_lens(
    lens_obj,
    *,
    name,
    source_schema_uri,
    target_schema_uri,
    code_repository,
    code_commit,
    description=None,
    rkey=None,
)
```

Publish a lens record from an existing Lens object.

This method extracts the getter and putter function names from
the Lens object and publishes a record referencing them.

Args:
    lens_obj: The Lens object to publish.
    name: Human-readable lens name.
    source_schema_uri: AT URI of the source schema.
    target_schema_uri: AT URI of the target schema.
    code_repository: Git repository URL.
    code_commit: Git commit hash.
    description: What this transformation does.
    rkey: Optional explicit record key.

Returns:
    The AT URI of the created lens record.